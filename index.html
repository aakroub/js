<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS-Quest: رحلتك لتعلم جافاسكريبت</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            scrollbar-width: thin;
            scrollbar-color: #4a5568 #2d3748;
        }
        body::-webkit-scrollbar {
            width: 8px;
        }
        body::-webkit-scrollbar-track {
            background: #2d3748;
        }
        body::-webkit-scrollbar-thumb {
            background-color: #4a5568;
            border-radius: 10px;
            border: 2px solid #2d3748;
        }
        .code-block {
            background-color: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 16px;
            font-family: 'Courier New', Courier, monospace;
            direction: ltr;
            text-align: left;
        }
        .console-output {
            background-color: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 8px;
            min-height: 100px;
            padding: 16px;
            font-family: 'Courier New', Courier, monospace;
            direction: ltr;
            text-align: left;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .console-output .error {
            color: #f56565;
        }
        .console-output .success {
            color: #48bb78;
        }
        .lesson-item.locked {
            color: #718096;
            cursor: not-allowed;
        }
        .lesson-item.locked .lock-icon {
            display: inline-block;
        }
        .lesson-item .lock-icon {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <div id="app" class="flex flex-col md:flex-row h-screen">
        
        <!-- Sidebar -->
        <aside class="w-full md:w-1/4 bg-gray-800 p-6 overflow-y-auto border-l-2 border-cyan-500">
            <h1 class="text-3xl font-bold text-cyan-400 mb-2">JS-Quest</h1>
            <p class="text-gray-400 mb-6">مسارك لتعلم جافاسكريبت</p>
            
            <div class="mb-6 bg-gray-700 p-4 rounded-lg">
                <h2 class="text-lg font-semibold text-gray-300">مستواك الحالي</h2>
                <div class="flex justify-between items-center mt-2">
                    <span id="level" class="text-cyan-400 font-bold text-xl">مبتدئ</span>
                    <span id="points" class="bg-cyan-500 text-gray-900 font-bold py-1 px-3 rounded-full">0 نقطة</span>
                </div>
            </div>

            <h2 class="text-2xl font-semibold mb-4 border-b-2 border-gray-700 pb-2">الدروس</h2>
            <ul id="lessons-list" class="space-y-2">
                <!-- Lessons will be dynamically inserted here -->
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="w-full md:w-3/4 p-8 overflow-y-auto">
            <div id="lesson-content">
                <!-- Welcome Message -->
                <div class="text-center h-full flex flex-col justify-center items-center">
                    <h1 class="text-5xl font-bold text-gray-300">أهلاً بك في JS-Quest</h1>
                    <p class="text-xl text-gray-400 mt-4">اختر درسًا من القائمة على اليمين لبدء رحلتك في عالم جافاسكريبت.</p>
                    <div class="mt-8">
                        <svg class="w-32 h-32 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                    </div>
                </div>
            </div>
        </main>

    </div>

    <script>
        const appState = {
            points: 0,
            currentLessonIndex: -1,
            lessonsCompleted: 0,
        };
        
        // بيانات الدروس والتحديات
        const lessons = [
            {
                title: "1. المتغيرات (Variables)",
                explanation: "المتغيرات هي حاويات لتخزين قيم البيانات. في جافاسكريبت، نستخدم الكلمات المفتاحية `let`, `const`, و `var` لإنشاء المتغيرات. `let` للمتغيرات التي يمكن تغيير قيمتها، و `const` للثوابت التي لا تتغير.",
                example: `let message = "مرحباً بالعالم";\nconsole.log(message);\n\nconst year = 2025;\nconsole.log(year);`,
                challenge: {
                    prompt: "قم بإنشاء متغير بإسم `playerName` باستخدام `let` وأعطه قيمة اسمك (كنص). ثم قم بإنشاء ثابت بإسم `score` باستخدام `const` وأعطه القيمة 100. أخيرًا، اطبعهما في الـ console.",
                    validate: (output) => output.includes("100") && output.length > 4,
                }
            },
            {
                title: "2. أنواع البيانات (Data Types)",
                explanation: "تحتوي جافاسكريبت على أنواع بيانات مختلفة. الأساسية هي: `String` (نص)، `Number` (رقم)، `Boolean` (صواب/خطأ)، `null` (فارغ)، و `undefined` (غير مُعرّف).",
                example: `let name = "Ali"; // String\nlet age = 30; // Number\nlet isDeveloper = true; // Boolean\n\nconsole.log(typeof name); // سيطبع "string"`,
                challenge: {
                    prompt: "أنشئ متغير `currentYear` بقيمة 2025 (Number)، ومتغير `isLearning` بقيمة `true` (Boolean). اطبعهما في الـ console.",
                    validate: (output) => output.includes("2025") && output.includes("true"),
                }
            },
            {
                title: "3. الدوال (Functions)",
                explanation: "الدوال هي كتل من الكود مصممة لأداء مهمة معينة. يمكن استدعاء الدالة لتنفيذ الكود الذي بداخلها. هذا يساعد على تنظيم الكود وإعادة استخدامه.",
                example: `function greet(name) {\n  console.log("مرحباً, " + name + "!");\n}\n\ngreet("أحمد"); // استدعاء الدالة`,
                challenge: {
                    prompt: "اكتب دالة اسمها `addNumbers` تأخذ رقمين كمدخلات (parameters) وتقوم بطباعة مجموعهما في الـ console. ثم قم باستدعاء الدالة مع الرقمين 5 و 10.",
                    validate: (output) => output.trim() === "15",
                }
            },
            {
                title: "4. الشروط (Conditional Statements)",
                explanation: "تُستخدم الشروط لتنفيذ أجزاء مختلفة من الكود بناءً على شرط معين. `if`, `else if`, و `else` هي الأدوات الرئيسية لذلك.",
                example: `let temp = 25;\n\nif (temp > 30) {\n  console.log("الجو حار جداً");\n} else if (temp > 20) {\n  console.log("الجو معتدل");\n} else {\n  console.log("الجو بارد");\n}`,
                challenge: {
                    prompt: "اكتب شرط `if/else`. إذا كان متغير `userScore` أكبر من 50، اطبع 'ناجح'. وإلا، اطبع 'راسب'. قم بتعريف `userScore` بقيمة 75.",
                    validate: (output) => output.trim().toLowerCase() === "ناجح",
                }
            },
            {
                title: "5. الحلقات التكرارية (Loops)",
                explanation: "الحلقات التكرارية تسمح لك بتكرار تنفيذ كتلة من الكود عدة مرات. أشهر أنواعها `for` و `while`.",
                example: `// طباعة الأرقام من 1 إلى 5\nfor (let i = 1; i <= 5; i++) {\n  console.log(i);\n}`,
                challenge: {
                    prompt: "استخدم حلقة `for` لطباعة كلمة 'JavaScript' في الـ console ثلاث مرات.",
                    validate: (output) => (output.match(/JavaScript/g) || []).length === 3,
                }
            },
            {
                title: "6. المصفوفات (Arrays)",
                explanation: "المصفوفات هي نوع خاص من المتغيرات يمكنه تخزين عدة قيم في مكان واحد. يمكن الوصول إلى عناصر المصفوفة باستخدام رقم الفهرس (index) الذي يبدأ من 0.",
                example: `let fruits = ["تفاح", "موز", "برتقال"];\nconsole.log(fruits[0]); // سيطبع "تفاح"\n\nfruits.push("مانجو"); // إضافة عنصر جديد\nconsole.log(fruits.length); // سيطبع 4`,
                challenge: {
                    prompt: "أنشئ مصفوفة اسمها `skills` تحتوي على ثلاث مهارات برمجية تعرفها (كنصوص). ثم قم بطباعة العنصر الثاني في المصفوفة.",
                    validate: (output) => output.trim().length > 1 && !output.includes("["),
                }
            },
            {
                title: "7. الكائنات (Objects)",
                explanation: "الكائنات هي حاويات لقيم مسماة تسمى خصائص (properties). تستخدم لتمثيل كيانات العالم الحقيقي، مثل سيارة أو شخص، بخصائصها وسلوكياتها.",
                example: `let car = {\n  type: "Fiat",\n  model: "500",\n  color: "white"\n};\n\nconsole.log(car.type); // سيطبع "Fiat"`,
                challenge: {
                    prompt: "أنشئ كائنًا اسمه `user` له خاصيتان: `name` بقيمة اسمك، و `age` بقيمة عمرك. ثم اطبع قيمة `name` في الـ console.",
                    validate: (output) => output.trim().length > 1 && !output.includes("{"),
                }
            },
            {
                title: "8. التعامل مع DOM",
                explanation: "نموذج كائن المستند (DOM) هو واجهة برمجية لصفحات الويب. يسمح لنا بتغيير محتوى وهيكل الصفحة باستخدام JavaScript. يمكننا تحديد العناصر باستخدام `document.getElementById` أو `document.querySelector`.",
                example: `// HTML: <h1 id="title">Hello</h1>\n\nlet pageTitle = document.getElementById("title");\nconsole.log(pageTitle.textContent); // سيطبع "Hello"`,
                challenge: {
                    prompt: "افترض أن الصفحة تحتوي على عنصر `<p id='message'>مرحباً</p>`. اكتب كود JavaScript لتحديد هذا العنصر وتغيير محتواه النصي إلى 'أهلاً جافاسكريبت'. (ملاحظة: لن ترى التغيير في هذه الصفحة، لكن الكود يجب أن يكون صحيحًا).",
                    validate: (output) => output.includes("getElementById") || output.includes("querySelector"),
                }
            },
            {
                title: "9. الأحداث (Events)",
                explanation: "الأحداث هي الإجراءات التي تحدث في صفحة الويب، مثل نقرة الماوس أو ضغطة المفتاح. يمكننا كتابة كود JavaScript للاستجابة لهذه الأحداث باستخدام `addEventListener`.",
                example: `// HTML: <button id="myBtn">Click me</button>\n\nlet button = document.getElementById("myBtn");\nbutton.addEventListener("click", function() {\n  console.log("تم النقر على الزر!");\n});`,
                challenge: {
                    prompt: "اكتب الكود اللازم لإضافة مستمع حدث (event listener) إلى زر له `id` يساوي `testButton`. عند النقر على الزر، يجب أن يطبع 'تم الاختبار بنجاح' في الـ console.",
                    validate: (output) => output.includes("addEventListener") && output.includes("click"),
                }
            },
            {
                title: "10. دوال السهم (Arrow Functions)",
                explanation: "دوال السهم هي طريقة مختصرة لكتابة الدوال في JavaScript، تم تقديمها في ES6. إنها تجعل الكود أقصر وأكثر قابلية للقراءة.",
                example: `// دالة عادية\nfunction add(a, b) {\n  return a + b;\n}\n\n// دالة سهم\nconst addArrow = (a, b) => a + b;\n\nconsole.log(addArrow(2, 3)); // سيطبع 5`,
                challenge: {
                    prompt: "حول الدالة العادية التالية إلى دالة سهم: `function multiply(x, y) { return x * y; }`. قم بتسمية دالة السهم `multiplyArrow` واستدعها مع الرقمين 4 و 5.",
                    validate: (output) => output.includes("=>") && output.includes("20"),
                }
            }
        ];

        const ui = {
            lessonsList: document.getElementById('lessons-list'),
            lessonContent: document.getElementById('lesson-content'),
            pointsDisplay: document.getElementById('points'),
            levelDisplay: document.getElementById('level'),
        };

        function init() {
            renderLessonsList();
            updateProgress();
        }

        function renderLessonsList() {
            ui.lessonsList.innerHTML = '';
            lessons.forEach((lesson, index) => {
                const isLocked = index > appState.lessonsCompleted;
                const li = document.createElement('li');
                li.className = `p-3 rounded-lg cursor-pointer transition-all duration-200 ${isLocked ? 'lesson-item locked bg-gray-700' : 'bg-gray-700 hover:bg-cyan-800 hover:text-white'}`;
                li.textContent = lesson.title;
                
                const lockIcon = document.createElement('span');
                lockIcon.className = 'lock-icon float-left';
                lockIcon.innerHTML = '🔒';
                li.appendChild(lockIcon);

                if (!isLocked) {
                    li.onclick = () => selectLesson(index);
                }
                
                ui.lessonsList.appendChild(li);
            });
        }
        
        function selectLesson(index) {
            appState.currentLessonIndex = index;
            const lesson = lessons[index];
            
            ui.lessonContent.innerHTML = `
                <h1 class="text-4xl font-bold text-cyan-400 mb-4">${lesson.title}</h1>
                <p class="text-lg text-gray-300 leading-relaxed mb-6">${lesson.explanation}</p>
                
                <h2 class="text-2xl font-semibold mb-3">مثال توضيحي:</h2>
                <div class="code-block text-gray-200 mb-8">
                    <pre><code>${lesson.example}</code></pre>
                </div>
                
                <h2 class="text-2xl font-semibold mb-3 text-yellow-400">التحدي:</h2>
                <p class="text-lg text-gray-300 mb-4">${lesson.challenge.prompt}</p>
                
                <textarea id="code-editor" class="w-full h-48 p-4 rounded-lg bg-gray-800 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500 font-mono text-lg" style="direction: ltr; text-align: left;"></textarea>
                
                <div class="my-4">
                    <button id="run-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">تشغيل الكود</button>
                    <button id="submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg transition-colors mr-3">تسليم الحل</button>
                </div>

                <h2 class="text-2xl font-semibold mb-3">الـ Console:</h2>
                <div id="console-output" class="console-output"></div>
            `;
            
            document.getElementById('run-btn').onclick = runCode;
            document.getElementById('submit-btn').onclick = submitChallenge;
        }

        function runCode() {
            const code = document.getElementById('code-editor').value;
            const consoleOutput = document.getElementById('console-output');
            consoleOutput.innerHTML = ''; 

            const originalLog = console.log;
            let capturedOutput = '';
            console.log = (...args) => {
                capturedOutput += args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : arg).join(' ') + '\n';
            };

            try {
                // For DOM challenges, we create dummy elements to avoid errors
                if (appState.currentLessonIndex === 7) {
                    const dummyP = document.createElement('p');
                    dummyP.id = 'message';
                    document.body.appendChild(dummyP);
                }
                 if (appState.currentLessonIndex === 8) {
                    const dummyBtn = document.createElement('button');
                    dummyBtn.id = 'testButton';
                    document.body.appendChild(dummyBtn);
                }

                eval(code);
                consoleOutput.textContent = capturedOutput || '(لا يوجد خرج)';
            } catch (error) {
                consoleOutput.innerHTML = `<span class="error">${error}</span>`;
            } finally {
                console.log = originalLog;
            }
        }
        
        function submitChallenge() {
            const code = document.getElementById('code-editor').value;
            const consoleOutput = document.getElementById('console-output');
            const lesson = lessons[appState.currentLessonIndex];

            const originalLog = console.log;
            let capturedOutput = '';
            console.log = (...args) => {
                 capturedOutput += args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : arg).join(' ') + '\n';
            };

            try {
                let isCorrect = false;
                 // Special validation for DOM challenges
                if (appState.currentLessonIndex === 7 || appState.currentLessonIndex === 8) {
                    isCorrect = lesson.challenge.validate(code);
                } else {
                    eval(code);
                    isCorrect = lesson.challenge.validate(capturedOutput);
                }

                if (isCorrect) {
                    consoleOutput.innerHTML = `<span class="success">رائع! إجابة صحيحة. لقد ربحت 350 نقطة.</span>`;
                    if (appState.currentLessonIndex === appState.lessonsCompleted) {
                        appState.points += 350;
                        appState.lessonsCompleted++;
                        updateProgress();
                        renderLessonsList();
                    }
                } else {
                    consoleOutput.innerHTML = `<span class="error">إجابة غير صحيحة. حاول مرة أخرى.</span><br>${capturedOutput}`;
                }

            } catch (error) {
                consoleOutput.innerHTML = `<span class="error">خطأ في الكود: ${error}</span>`;
            } finally {
                console.log = originalLog;
            }
        }
        
        function updateProgress() {
            ui.pointsDisplay.textContent = `${appState.points} نقطة`;
            
            let level = "مبتدئ";
            if (appState.points >= 3500) level = "ساحر جافاسكريبت";
            else if (appState.points >= 2450) level = "خبير";
            else if (appState.points >= 1400) level = "متمرس";
            else if (appState.points >= 700) level = "متوسط";
            else if (appState.points >= 350) level = "متعلم";

            ui.levelDisplay.textContent = level;
        }

        init();
    </script>
</body>
</html>

